<p id="notice"><%= notice %></p>

<h1>Your Pragmatic Cataloge - viewed: <%= pluralize @counter, 'time' %></h1>
<%# <%= insert cache for @products list %>
<% cache @products do %>
  <% @products.each do |product| %>
    <%# <%= insert cache for individual product %>
    <% cache product do %>
      <div class="entry">
        <%# click on image also invoke the create action %>
        <%= link_to(image_tag(product.image_url), line_items_path(:product_id => product), :method=> :post) %>
        <h3><%= product.title %></h3>
        <%= sanitize(product.description) %>
        <div class="price_line">
          <span class="price"> <%= number_to_currency(product.price) %> </span>
          <%= button_to 'Add to Cart', line_items_path(product_id: product) %>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
